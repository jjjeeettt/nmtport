{% extends "base.html" %}
{% block main %}



<p class="text-muted"> дата: <strong>{{date_shift}} </strong>смена: <strong>{{shift}} </strong> </p>
<!-- <div class="progress"> -->
<!--     <div class="progress-bar bg-danger" role="progressbar"  style="width: 1%" ></div> -->
<!--     <div class="progress-bar bg-warning"  role="progressbar" style="width: 3%" alt='444'><small>20:45</small></div> -->
<!--     <div class="progress-bar"  role="progressbar" style="width: 19%"><small>21:45</small></div> -->
<!-- </div> -->
<!-- <br /> -->
<!-- <br /> -->



<script>
function hours(shift){
    if (shift==1) {
        hs = ['08', '╵','09', '╵','10', '╵','11', '╵','12', '╵','13', '╵','14', '╵','15', '╵','16', '╵','17', '╵','18', '╵','19', '╵', '20'] }
    else {
        hs = ['20', '╵','21', '╵','22', '╵','23', '╵','00', '╵','01', '╵','02', '╵','03', '╵','04', '╵','05', '╵','06', '╵','07', '╵', '08'] }
    document.write(' <small class="text-muted"> <div class="d-flex justify-content-between">');
        for (var h in hs) {
            document.write('<div class="text-center">'+hs[h]+'</div>');
        }
    document.write(' </div> </small>');
    }

   
  function progress_bar_time(list, shift){
    document.write('<div class="progress">') ;
    for (var id in list) {
        n=list[id].value;
      if (n==-1){
        document.write('<div class="progress-bar bg-danger" role="progressbar"  style="width: 0.14%" ></div>'); }
      else if (n==0){
        document.write('<div class="progress-bar bg-warning"  role="progressbar" style="width: 0.14%"></div>'); }
      else {
        document.write('<div class="progress-bar"  role="progressbar" style="width: 0.14%"></div>') ; }
      }
      document.write('</div>');
    hours(shift);
    }


  function progress_bar_time_test(list, shift){
    document.write('<div class="progress">') ;
    var tmp = -1;
    var lengthBar=0;
    var start=0;
    var count=0;

    for (var id in list) {
        n=list[id].value;

        if (n!=tmp) {
           tmp=n;
           start=list[id].time;
        
            <!-- document.write(lengthBar+' | '); --> 
            if (n==-1){
                document.write('<div class="progress-bar bg-danger" role="progressbar"  style="width:'+ lengthBar+ '%" ></div>'); }
            else if (n==0){
                document.write('<div class="progress-bar bg-warning"  role="progressbar" style="width:'+lengthBar + '%"></div>'); }
            else {
                document.write('<div class="progress-bar"  role="progressbar" style="width:' + lengthBar +'%"></div>') ; }
            lengthBar=0;
            }
        else {
            count++;
            lengthBar+=0.139;
        }
    }
    document.write('</div>');
    hours(shift);
    tmp = -1;
    lengthBar=0;
    start=0;
    count=0;
    }


    var valByMins = JSON.parse('{{  data | tojson | safe}}');
    var shift = '{{shift}}';

        for (var key in valByMins) {
            document.write('<div class="h5">'+ valByMins[key].name+ ' ' );
            document.write('<span class="badge badge-secondary">' + valByMins[key].total + '</span></div>');
            progress_bar_time(valByMins[key].data, shift);
        }


</script>
{% endblock %}
